#{extends 'stelper.html'/}
<div>
#{ifErrors }
	<div class="alert alert-error">
		<ul>
			#{list errors}
				<li>#{error /}</li>
			#{/list}
		</ul>
	</div>
#{/ifErrors}
	<div>
	<div class="post well well-large">
		<span>Posted At : <span class="label"> ${post.postedAt.format("dd.MM HH:mm")}</span></span>
		<span class="hidden">${post.type}</span>

		<div class="ratingDiv">Rate this post<br>
			<span data-type="POSITIVE" title="I like this post" class="badge badge-success rating">
				${post.rating.positive}
			</span>

			<span data-type="NEGATIVE" title="I hate it!!" class="badge badge-important rating">
			${post.rating.negative}
			</span>

		</div>
	#{list items:post.posts , as:'langPost'}
		<span class="author label label-info">by ${post.author.username}</span>

		<h3>${langPost.title}</h3>

		<p><span>${langPost.body}</span></p>
		<br>
	</div>
		<div id="commentTrees">
			<h4>Comments</h4>
			#{list langPost.commentTrees, as:'commentTree'}
				<div class="commentTree well well-small">
					#{list commentTree.comments ,as:'comment'}
						<div class="comment well well-small">
							<span class="label">${comment.postedAt.format("dd.MM HH:mm")}</span>
							<span class="author label label-info">by ${comment.author.username}</span>

							<p>
								<span>${comment.body}</span>
							</p>
						</div>
					#{/list}
					<span data-id="${commentTree.id}" class="reply label label-info">Reply</span>
				</div>
				<div id="${commentTree.id}" class="hidden commentReply">#{addSubComment commentTree.id/}</div>
			#{/list}
		</div>
	#{/list}
	</div>
	<div> #{addCommentTree /}</div>
</div>
<script type="text/javascript">
	$(document).ready(function () {
		$('span.reply.label.label-info').on('click', function () {
			var divId = $(this).data('id');
			$('div#' + divId).slideToggle();
		});
		$('span.rating').on('click', function () {
			var type = $(this).data('type');
			window.location = '/rating/ratepost?ratingType=' + type;
		});
	});
</script>